# Prompt 09: Update Documentation for MongoDB

## Objective
Update all CodeAI documentation to reflect the new MongoDB support feature, including configuration guides, quickstart steps, DSL syntax examples, and comparison tables.

## Files to Update

### 1. docs/03-database.md
Add comprehensive MongoDB section after the PostgreSQL content:

**Structure:**
- MongoDB Configuration
  - Connection string format
  - Environment variables (MONGODB_URI, MONGODB_DATABASE)
  - Connection pool settings
  - SSL/TLS options
- Collections vs Models
  - Document-based collections vs relational models
  - Schema flexibility
  - Embedded documents and references
- CRUD Operations
  - Create, Read, Update, Delete examples in DSL
  - Bulk operations
  - Upsert operations
- Querying
  - Query builder syntax for MongoDB
  - Aggregation pipeline examples
  - Index usage
- Transactions
  - Multi-document ACID transactions
  - Transaction scope
  - Error handling
- Comparison Table: PostgreSQL vs MongoDB
  - When to use each
  - Feature parity matrix
  - Performance considerations

### 2. docs/quickstart.md
Add MongoDB quick start section:

**Content:**
- Docker setup for MongoDB (testcontainers example)
- Basic MongoDB collection definition in .cai file
- Environment variable configuration
- First CRUD operation example
- Running tests with MongoDB backend

### 3. docs/dsl_cheatsheet.md
Add MongoDB syntax examples:

**Sections to add:**
```
## MongoDB Collections

database mongodb {
  collection users {
    field _id: objectid primary
    field email: string unique
    field profile: document {
      field name: string
      field age: int
    }
    field tags: array[string]
    field created_at: datetime

    index email
    index created_at desc
  }
}

## MongoDB Queries

query find_user_by_email(email: string) -> users {
  filter { email: $email }
}

query users_by_tags(tags: array[string]) -> users {
  filter { tags: { $in: $tags } }
}
```

### 4. docs/README.md
Update documentation index to reference MongoDB support:

**Changes:**
- Add MongoDB to the database section description
- Add link to MongoDB configuration examples
- Update "Supported Databases" list

### 5. Update Main README.md (project root)
Add MongoDB to environment variables section:

**Environment Variables:**
```bash
# MongoDB Configuration
MONGODB_URI=mongodb://localhost:27017
MONGODB_DATABASE=codeai
MONGODB_MAX_POOL_SIZE=100
MONGODB_MIN_POOL_SIZE=10
```

## Comparison Table Format

Create a clear comparison table in 03-database.md:

| Feature | PostgreSQL | MongoDB |
|---------|-----------|---------|
| Data Model | Relational tables | Document collections |
| Schema | Fixed schema | Flexible schema |
| Transactions | Full ACID | Multi-document ACID |
| Joins | Native joins | $lookup aggregation |
| Best For | Complex relationships, strict schema | Flexible documents, nested data |
| Query Language | SQL-like DSL | MongoDB query DSL |

## Use Case Guidelines

Document when to choose each database:

**Choose PostgreSQL when:**
- You have complex relationships between entities
- You need strict schema enforcement
- You require complex joins and transactions
- Data integrity is critical

**Choose MongoDB when:**
- Your data is document-oriented
- You need schema flexibility
- You have nested/hierarchical data
- You need horizontal scalability

## Testing Examples

Add examples showing how to run tests with MongoDB:

```bash
# Run tests with MongoDB backend
DATABASE_TYPE=mongodb make test

# Run specific MongoDB integration tests
go test ./test/integration/mongodb/...
```

## Success Criteria
- [ ] All 5 documentation files updated
- [ ] MongoDB configuration fully documented
- [ ] DSL syntax examples added to cheatsheet
- [ ] Comparison table created
- [ ] Quick start guide includes MongoDB setup
- [ ] Environment variables documented
- [ ] Testing instructions added
